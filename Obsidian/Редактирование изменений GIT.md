21.04.2023    15:46
Теги: #Git #Программирование 
---
# ***Внутренние ссылки:***
[Другие опции для команды `git log` можно посмотреть в руководстве по использованию Git:](https://git-scm.com/book/ru/v2/Основы-Git-Просмотр-истории-коммитов#rlog_options](https://git-scm.com/book/ru/v2/%D0%9E%D1%81%D0%BD%D0%BE%D0%B2%D1%8B-Git-%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80-%D0%B8%D1%81%D1%82%D0%BE%D1%80%D0%B8%D0%B8-%D0%BA%D0%BE%D0%BC%D0%BC%D0%B8%D1%82%D0%BE%D0%B2#rlog_options)

---
# ***Внешние ссылки:***

---
# ***Заметка:***

# Команды:

`git log` — показывает историю коммитов

`git log -2` — показывает последние 2 коммита

`git log -p` — расширенный вывод истории: выводит то же, что и git log, но еще и с изменениями в файлах

`git log --oneline`  — выводит коммиты в одну строку, показывая только хэш коммита и commit message

`git log --pretty=format:" "` — меняет формат вывода лога в соответствии с указанными в кавычках параметрами
## Прыгаем по коммитам

`git show`  — показывает информацию по отдельному коммиту

`git log` — показывает историю коммитов

`git checkout -- file1.txt` — отменяет изменения в рабочем каталоге, переключает на указанный файл

`git checkout хэш-коммита` — переводит на любой коммит в истории наших изменений

`git diff --staged` — выводит разницу между индексом и последним коммитом

# Редактирование закоммиченных файлов

Чтобы добавить **все** изменения, мы можем использовать любую из следующих команд:

`git add *`

или `git add -А`

или `git add .`

В первой версии репозитория хранятся созданные нами 3 файла: file1.txt и file2.txt закоммичены, file3.txt отслеживается. Во второй хранятся эти же самые файлы, но file1.txt и file3.txt изменены (в file1.txt мы поменяли содержание, а file3.txt закоммитили), а file2.txt остался такой же, как и в первой версии. Если, например, нам что-то надо поменять в file3.txt, то мы его редактируем, а потом коммитим — у нас уже будет третья версия нашего репозитория:

![[Pasted image 20230421155053.png]]

Каждым новым коммитом мы создаем новую версию нашего репозитория. И на каждую версию мы можем вернуться, когда захотим.

## История изменений

В истории сохраняются все коммиты, по которым можно посмотреть автора коммита, комментарий, дату коммита и его хэш. А также можно увидеть измененные файлы и изменения в каждом файле: Git хранит буквально все, от самого начала проекта.

![[Pasted image 20230421160929.png]]

# Как посмотреть историю изменений (коммитов)?

История коммитов содержит сведения о каждом проведенном коммите проекта. Запросить историю изменений можно с помощью команды 

`git log`:

![[Pasted image 20230421160948.png]]

Эта команда `git log` выводит все коммиты от новых к старым и всю информацию о каждом отдельном коммите:

- его хэш 

- автор (то имя и имейл, которые мы отконфигурированы при настройке Git)    

- дата, когда они были сделаны изменения 

- комментарий к коммиту (commit message)  

Для того, чтобы выйти из лога, достаточно нажать клавишу  `q`.

## Параметры (флаги) для команды `git log`

В сочетании с различными параметрами эта команда выводит историю по-разному, мы можем "фильтровать логи" так, как нам удобно:

1) `git log -число` — ограничит количество отображаемых коммитов этим числом. Например, мы хотим посмотреть только последний коммит, нет необходимости просматривать все, поэтому `git log -1` покажет наш последний коммит (он будет первым в списке выведенных коммитов). Соответственно, если мы хотим ограничить количество записей в выводе команды до двух, то используем параметр `-2` и т.д.

2)  `-p` — отобразит разницу, внесенную в каждый коммит. Разница часто называется диффом, а аргумент `-p` иногда заменяют на `--patch`. Часто используют для код-ревью, т.к. мы можем быстро просмотреть все внесенные изменения. Посмотрим, например, что мы внесли в последний коммит с помощью команды `git log -1 -p`
![[Pasted image 20230421161001.png]]

3) `--stat` покажет краткую статистику по каждому коммиту

![[Pasted image 20230421161009.png]]

 `git log --stat` выводит список коммитов и под каждым коммитом показывает автора, дату, комментарий, файлы, количество добавленных (зеленые плюсики) и удаленных строк (красные минусики) в этих файлах, а также какие изменения были сделаны (changed, insertions). 

4) `--pretty` меняет формат вывода лога. В сочетании с аргументом `format`  и необходимыми параметрами для вывода информации (перечисляются после двоеточия в кавычках вместе со знаком % и через пробел; все доступные параметры указаны ниже) мы можем сгенерировать вывод информации по коммитам для автоматического анализа:

`git log --pretty=format:"%h %an %ae %s"`

Запись "%h %an %ae %s"  означает, что информацию по коммитам мы хотим видеть в следующем формате: "%сокращенный_хэш_коммита   %кто_сделал   %с_какой_почты   %с_каким_комментарием_к_коммиту". Ниже приведен список популярных параметров формата, а весь список можно посмотреть тут: [https://mirrors.edge.kernel.org/pub/software/scm/git/docs/git-log.html#_pretty_formats](https://mirrors.edge.kernel.org/pub/software/scm/git/docs/git-log.html#_pretty_formats)

![[Pasted image 20230421161017.png]]

Причем формат не будет меняться даже после обновления Git:
![[Pasted image 20230421161051.png]]
 5) `--oneline` отобразит каждый коммит в одну строку, что удобно для просмотра большого количества коммитов:
![[Pasted image 20230421161042.png]]
6) Найти коммиты определенного автора можно командой

`git log --author="Кот Бантик"`

## Просмотр отдельного коммита `git show`

Чтобы просмотреть отдельный коммит, нам нужна команда `git show` и хэш коммита. Хэш выводится в любой команде `git log`. В примере ниже команда `git log --oneline` показала историю коммитов:

![[Pasted image 20230421161115.png]]
Посмотрим в ней второй коммит: `git show a65aa43`.    
Хэш коммита 40-символьный, но команда `git log --oneline` выводит именно короткий хэш — всего 7 символов. Для некоторых операций с коммитами можно использовать даже первые 4 символа. Например, 3 команды ниже покажут содержимое одного и того же коммита:

![](https://ucarecdn.com/62d129af-84b4-44aa-9efc-8526c41f68f8/)

Вообще команда `git show` используется для вывода полной информации о коммите, ветке и других объектах Git.

### Немного практики

Итак, в первом шаге мы создали папку, а в ней три файла. Создадим теперь 4-й файл — file4.txt — с содержанием "HelloGit", проиндексируем его и закоммитим с сообщением "Added File4":

`echo "HelloGit" > file4.txt`     ->    `git add file4.txt`   ->   `git commit -m "Added File4"`

Посмотрим теперь все наши коммиты  с помощью `git log` (сделайте это самостоятельно).

Зайдем в наш последний коммит с помощью `git log -1 -p`

![[Pasted image 20230421160749.png]]
Гит отписался, что добавил новый файл со строчкой "HelloGit".

Теперь создадим еще и пятый файл с текстом "аа" внутри, а в четвертый файл тоже добавим текст "аа":

`echo "аа" > file5.txt`

`echo "аа" >> file4.txt`

**! Обратите внимание, при использовании символа  `>` в команде `echo` файл будет создан, а символ `>>`  добавит что-то в уже существующий файл. !**

Посмотрим статус:

![](https://ucarecdn.com/0c7d1995-d8ae-4727-ad0d-80f1f642db83/)

Проиндексируем, закоммитим с сообщением "few changes" и посмотрим историю изменений:

![](https://ucarecdn.com/8014124a-07d7-48ee-8e29-2353fe825847/)

Теперь зайдем в последний коммит с помощью git log -1 -p:

![](https://ucarecdn.com/bfcbf50a-8c40-44f0-abb8-f6c1b493aa23/)

Видим, что в file4.txt был добавлен текст "аа" (посветил зеленым +аа), и создался новый файл file5.txt (new file) с текстом "аа". Все добавленные файлы отображаются после трех плюсиков, все удаленные после трех минусов.

Зайдем в file4.txt с помощью `nano file4.txt`, удалим текст "HelloGit" и добавим текст "bbb", проиндексируем файл и закоммитим с каким-нибудь сообщением. Затем посмотрим этот коммит и увидим, все, что мы отредактировали:

![](https://ucarecdn.com/f9cffe30-7335-47a9-abb5-fee4332ba6a4/)

