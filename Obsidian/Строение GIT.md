16.04.2023    17:55
Теги: #Программирование #Git 
---
# ***Внутренние ссылки:***

---
# ***Внешние ссылки:***

---
# ***Заметка:***

1. Git — распределенная система контроля версий, позволяющая сохранять изменения, внесённые в файлы, которые хранятся в репозитории.

2. Git хранит все файлы и связи между ними, как объекты (=файлы с определенной информацией о репозитории)

3. Все файлы проходят через несколько секций: рабочий каталог (working directory), область подготовленных файлов или индекс (staging area) и локальный git-каталог (local git repository). Только потом они отправляются на сервер в удаленный репозиторий (remote git repository):

![[Pasted image 20230416180522.png]]

4. Working directory — рабочий каталог, содержит файлы, с которыми мы работаем напрямую.

5. Staging area (индекс) — нужна Git, чтобы понимать, какие из файлов мы добавим в последующий коммит, а какие – нет.

# **Строение Git**

**working directory** – рабочий каталог,  каталог проекта, в котором содержится папка .git, рабочая копия определенной версии проекта

**stage (staging area)** = **индекс** — специальная промежуточная область, в которой хранится информация о том, что должно войти в следующий коммит

**каталог Git** = Git repository = репозиторий Git = Git directory — локальный репозиторий гита

Все принадлежащие гиту файлы проходят через несколько секций хранилища: рабочий каталог (working directory), область/стадия подготовленных файлов или индекс (staging area, "стейджинг-зона") и git-каталог (git directory).

Наши файлы путешествуют между этими тремя областями. Файлы, с которыми мы работаем напрямую – это working directory. Что-то изменили в этих файлах – изменилось состояние рабочего каталога.

![[Pasted image 20230416175534.png]]

**Рабочий каталог** (working directory) — это каталог нашего проекта, сжатая база данных.

Стадия подготовленных файлов (**индекс**) — это промежуточная область между двумя каталогами, куда мы будем добавлять файлы, которые будут переданы в репозиторий Git для отслеживания их версий.

**git-каталог** — это и есть локальный репозиторий Git, который был клонирован с сервера. Это самая важная часть системы: именно тут хранятся все объекты и данные нашего проекта (и их версии): код, изображения, файлы конфигурации, скрипты, стили. Этот репозиторий мы потом и будем пушить на сервер.

Мы склонировали с удаленного репозитория копию определенной версии проекта. Она — это и есть рабочий каталог, который находится теперь у нас на жестком диске компьютера. В нем мы будем производить все действия по редактированию файлов: переписывать код, менять шрифты, цвета, добавлять новые блоки и функции, удалять старые и т.д.

Как только мы что-то сделали с файлом, он получает статус "измененный" и, если мы хотим, чтобы Git добавил его под версионный контроль, перемещаем его в индекс (промежуточную зону), если не хотим, то никуда его не перемещаем.

Отслеживаемые файлы — это те файлы, которые были в последнем коммите, и гит знает об их существовании — они находятся под версионным контролем. Неотслеживаемые файлы — это все те файлы в нашем рабочем каталоге, которые не входили в последний коммит и не подготовлены к коммиту.  Когда мы впервые клонируем репозиторий, все файлы будут отслеживаемыми и неизмененными, потому что Git только что их извлек, и мы ничего пока не редактировали.

Как только мы изменим какой-то файл, Git будет рассматривать его как измененный — ведь мы изменили его с момента последнего коммита. Если мы хотим, чтобы гит добавил его под версионный контроль (хотим зафиксировать эти изменения), то добавляем файл во вторую область — staging area. Это некое среднее состояние между working directory и Git directory, показывает, что изменения уже на пути к фиксации, но еще не сохранены в базе Git.

Здесь он приобретает статус "индексирован" (staged). Staged — значит готов к отправке в репозиторий (готов коммиту), где он станет "зафиксированным" (committed). Файл будет находиться в индексе до тех пор, пока мы не сохраним его в локальное хранилище и не отправим на сервер.

Если мы уверены, что все изменения, которые мы добавили в staging area, необходимо сохранить в базу Git, то делаем коммит. Они в сжатом виде помещаются в Git directory.

Теперь все надежно сохранено в папке .git.

# **Внутреннее устройство Git. Объекты.**
Всю информацию Git представляет в виде своих "объектов" – специальных файлов, содержащих определенную информацию о репозитории с его файлами. Все объекты хранятся в папке .git/objects/  и являются git-объектами одного из 4-х разных типов: "блоб", "дерево", "коммит" или "таг".

- "блоб" (blob) используется чтобы хранить содержимое файла, обычно это большой бинарный файл типа:

```
703ec79a98c1d097d5b1cd320befffa376e826
```

Это blob-файл — начальное представление данных в Git — один файл на единицу хранения. Он формируется для каждого файла в репозитории и содержит его имя и сжатое содержимое. Блоб-файл просто хранит снимок содержимого файла, он формируется, когда мы добавляем файл в индекс.

- "дерево" (tree) – содержит одну или более записей, указывающей на другое дерево или на blob-объект. Это что-то вроде директории, которая показывает связи между файлами в репозитории. Оно ссылается на группу других деревьев и блобов, показывает, какие файлы и папки лежат в данной директории. Объект дерево формируется для каждой папки репозитория во время коммита и состоит из имен блоб-объектов (для файлов, которые лежат в данной папке) и других деревьев для всех поддиректорий. Если blob-объекты хранят информацию о файлах репозитория и их содержимом, то tree-объекты хранят информацию о расположении этих файлов в репозитории.

- "коммит" – это объект, который указывает на отдельное дерево, фиксируя в истории каким образом оно выглядит в момент выполнения коммита. Он содержит мета информацию: имя автора коммита, время коммита, указатель на предыдущий коммит и tree-объект корневой директории проекта.

- "таг" — это способ маркировать (дать какое либо легко запоминающееся имя) определенный коммит как специфический, чтобы впоследствии было легче его найти.
Кроме перечисленных объектов важным во внутреннем устройстве Git является индекс — промежуточная область, куда добавляются файлы перед коммитом.

![[Pasted image 20230416180015.png]]
# **Имена объектов в индексе**

Для обеспечения целостности данных Git использует специальные имена — SHA-1 хэши. Это контрольная хэш-сумма содержимого и заголовка объекта, уникальный идентификатор для каждого объекта. Подробнее о том. что такое SHA-1 можно почитать тут: [https://ru.wikipedia.org/wiki/SHA-1](https://ru.wikipedia.org/wiki/SHA-1)

Каждому blob-объекту Git присваивает имя — SHA-1 хэш. Эта 40-значная строка и будет единицей хранения файла в репозитории гита. Первые два символа SHA определяют подкаталог файла, остальные 38 — имя. Эти идентификаторы используются для перемещения по временной шкале коммитов и возвращения к коммитам. Все файлы ссылаются друг на друга с помощью 40-значного SHA-1 хэша, его можно посмотреть в репозитории:

![[Pasted image 20230416180233.png]]

 Данный объект ![](https://ucarecdn.com/98a0cbae-bc41-4b52-aea7-26a7e9ca8f40/) и есть SHA-1 хэш. Он хранит снимок содержимого определенного файла.

С помощью SHA-1 хэшей Git работает надежно и достаточно быстро. Git любит эти 40-значные строки: они сводят возможность найти два разных объекта с одинаковым именем практически к нулю. Сравнив имена объектов, Git сразу определит, идентичны ли сами объекты. Кроме того, раз имена объектов вычисляются одинаково во всех репозиториях, то объекты с одинаковым содержимым в двух репозиториях всегда будут хранится под одинаковыми именами. И конечно же, Git найдет ошибки когда читает объект, сравнив хэш значение содержимого объекта с его именем.

Итак, простое добавление файла в Git приводит к сохранению его содержимого в папке objects. И это добавление будет храниться там, даже если мы удалим сам файл из рабочей копии.
